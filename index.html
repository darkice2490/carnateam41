<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CARNATEAM</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom, #0a1628, #122b45);
      color: white;
      padding: 1rem;
    }
    .container {
      max-width: 400px;
      margin: 0 auto;
    }
    h1, #welcome {
      text-align: center;
      font-size: 2rem;
    }
    .button {
      display: inline-block;
      margin: 0.5rem 0.25rem;
      padding: 0.75rem 1rem;
      border: none;
      border-radius: 0.5rem;
      background-color: #1e3a8a;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    input, textarea {
      width: 100%;
      margin-top: 0.5rem;
      padding: 0.75rem;
      border-radius: 0.5rem;
      border: none;
      font-size: 1rem;
    }
    .input-group {
      margin-bottom: 1rem;
    }
    .photo-button {
      background-color: #334155;
      color: white;
      padding: 0.5rem;
      border-radius: 0.5rem;
      cursor: pointer;
      text-align: center;
    }
    .trip {
      background-color: #1e293b;
      padding: 0.75rem;
      border-radius: 0.5rem;
      margin-top: 1rem;
    }
    .link {
      color: #60a5fa;
      text-decoration: none;
    }
    .fish-index {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
      font-size: 0.9rem;
      margin: 0.5rem auto;
    }
    .low {
      background-color: #dc2626;
    }
    .medium {
      background-color: #f97316;
    }
    .high {
      background-color: #16a34a;
    }
    .fish-icon {
      font-size: 1.5rem;
    }
    .footer {
      margin-top: 2rem;
      text-align: center;
      font-size: 0.8rem;
      color: #cbd5e1;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Carnet de P√™che</h1>

    <div class="input-group">
      <label for="prenom">Pr√©nom</label>
      <input type="text" id="prenom" placeholder="Pr√©nom">
    </div>
    <div class="input-group">
      <label for="nom">Nom</label>
      <input type="text" id="nom" placeholder="Nom">
    </div>
    <div class="input-group">
      <label for="photo">Photo (facultative)</label>
      <input type="file" id="photo">
    </div>
    <button class="button" onclick="connexion()">Se connecter</button>

    <div id="welcome"></div>

    <button class="button" onclick="geolocaliser()">üìç Utiliser ma position</button>
    <button class="button">Ajouter une sortie</button>
    <button class="button">Voir la carte</button>

    <div class="input-group">
      <label for="lieu">Nom du lieu</label>
      <input type="text" id="lieu" placeholder="√âtang de la Varenne">
    </div>

    <div class="input-group">
      <label for="localisation">Localisation</label>
      <input type="text" id="localisation" placeholder="Ville, GPS ou adresse">
    </div>

    <div class="input-group">
      <label for="especes">Esp√®ces p√™ch√©es</label>
      <input type="text" id="especes" placeholder="Carpe, brochet, br√®me...">
    </div>

    <div class="input-group">
      <label for="notes">Notes</label>
      <textarea id="notes" placeholder="Fond vaseux, vent faible, app√¢t utilis√©..."></textarea>
    </div>

    <div class="input-group">
      <div class="photo-button">üì∏ Ajouter une photo</div>
    </div>

    <button class="button">Enregistrer</button>

    <h2>Sorties r√©centes</h2>
    <div class="trip">
      <strong>12 avril - 08:15</strong><br>
      √âtang de la Varenne<br>
      üå§Ô∏è Conditions m√©t√©o : l√©g√®res brises
    </div>
    <div class="trip">
      <strong>5 avril - 07:30</strong><br>
      Villefranche<br>
      üåßÔ∏è Conditions m√©t√©o : pluie l√©g√®re
    </div>

    <div id="meteo" style="margin-top: 1rem; padding: 1rem; background-color: #1e293b; border-radius: 0.5rem;">
      üìç <strong>M√©t√©o actuelle</strong><br>
      <span id="meteo-info">En attente...</span>

      <div id="indice-peche" class="fish-index">
        <span class="fish-icon">üêü</span>
      </div>
    </div>

    <p><a href="#" class="link">üå¶Ô∏è Conditions m√©t√©o en temps r√©el</a></p>

    <div class="footer">
      D√©velopp√© avec üé£ par CARNATEAM. Version b√™ta.
    </div>
  </div>

  <script>
    function calculerIndicePeche(temp, vent) {
      let score = 0;
      if (temp >= 15 && temp <= 25) score += 50;
      if (vent >= 1 && vent <= 10) score += 40;
      if (score > 80) return { pourcentage: score, niveau: 'high' };
      if (score > 50) return { pourcentage: score, niveau: 'medium' };
      return { pourcentage: score, niveau: 'low' };
    }

    async function afficherMeteoParCoordonnees(lat, lon) {
      const apiKey = "29808f7f46c2668ac411ad6374d444dc";
      const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric&lang=fr`;

      try {
        const res = await fetch(url);
        const data = await res.json();
        if (data.cod === 200) {
          const temp = data.main.temp;
          const vent = data.wind.speed;
          const info = `üå°Ô∏è ${temp}¬∞C, ${data.weather[0].description}, üí® vent ${vent} km/h`;
          document.getElementById("meteo-info").innerText = info;

          const indice = calculerIndicePeche(temp, vent);
          const elem = document.getElementById("indice-peche");
          elem.className = `fish-index ${indice.niveau}`;
          elem.innerHTML = `<span class="fish-icon">üêü</span> ${indice.pourcentage}%`;
        } else {
          document.getElementById("meteo-info").innerText = "Erreur m√©t√©o.";
        }
      } catch (err) {
        document.getElementById("meteo-info").innerText = "Erreur de chargement.";
      }
    }

    function geolocaliser() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(position => {
          const lat = position.coords.latitude;
          const lon = position.coords.longitude;
          afficherMeteoParCoordonnees(lat, lon);
          document.getElementById("localisation").value = `${lat.toFixed(4)}, ${lon.toFixed(4)}`;
        }, () => {
          alert("Impossible d'obtenir votre localisation.");
        });
      } else {
        alert("La g√©olocalisation n'est pas support√©e par ce navigateur.");
      }
    }

    function connexion() {
      const prenom = document.getElementById("prenom").value;
      if (prenom) {
        document.getElementById("welcome").innerText = `Bonjour ${prenom}, pr√™t √† p√™cher !`;
      }
    }
  </script>
</body>
</html>
